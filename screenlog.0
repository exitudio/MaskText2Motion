blank_id: 88
index_motion: torch.Size([128, 196])
(index_motion == blank_id): tensor([[False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        ...,
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True]], device='cuda:0')

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:18<00:00,  9.01s/it][A100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:18<00:00,  9.12s/it]
2023-03-29 22:13:35,847 INFO --> 	 Eva. Iter 3 :, FID. 72.6606, Diversity Real. 11.0464, Diversity. 2.4689, R_precision_real. [0.1640625  0.30078125 0.43359375], R_precision. [0.00390625 0.00390625 0.01171875], matching_score_real. 2.64396071434021, matching_score_pred. 9.672916412353516
2023-03-29 22:13:35,849 INFO --> --> 	 FID Improved from 101.30628 to 72.66058 !!!
2023-03-29 22:13:35,998 INFO --> --> 	 matching_score Improved from 11.81551 to 9.67292 !!!
2023-03-29 22:13:35,998 INFO --> --> 	 Top1 Improved from 0.0000 to 0.0039 !!!
2023-03-29 22:13:35,998 INFO --> --> 	 Top2 Improved from 0.0000 to 0.0039 !!!
2023-03-29 22:13:35,998 INFO --> --> 	 Top3 Improved from 0.0000 to 0.0117 !!!
  0%|                                                                                                                                             | 2/300000 [00:42<1757:14:27, 21.09s/it]
  0%|                                                                                                                                                               | 0/2 [00:00<?, ?it/s][Ablank_id: 88
index_motion: torch.Size([128, 196])
(index_motion == blank_id): tensor([[False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        ...,
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True]], device='cuda:0')

 50%|███████████████████████████████████████████████████████████████████████████▌                                                                           | 1/2 [00:09<00:09,  9.72s/it][Ablank_id: 88
index_motion: torch.Size([128, 196])
(index_motion == blank_id): tensor([[False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        ...,
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True]], device='cuda:0')

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:18<00:00,  9.06s/it][A100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:18<00:00,  9.22s/it]
2023-03-29 22:13:56,165 INFO --> 	 Eva. Iter 4 :, FID. 83.4699, Diversity Real. 10.7615, Diversity. 1.6848, R_precision_real. [0.1875    0.296875  0.4296875], R_precision. [0.0234375  0.02734375 0.0390625 ], matching_score_real. 2.6467034816741943, matching_score_pred. 9.453667163848877
2023-03-29 22:13:56,166 INFO --> --> 	 matching_score Improved from 9.67292 to 9.45367 !!!
2023-03-29 22:13:56,167 INFO --> --> 	 Top1 Improved from 0.0039 to 0.0234 !!!
2023-03-29 22:13:56,167 INFO --> --> 	 Top2 Improved from 0.0039 to 0.0273 !!!
2023-03-29 22:13:56,167 INFO --> --> 	 Top3 Improved from 0.0117 to 0.0391 !!!
  0%|                                                                                                                                             | 3/300000 [01:02<1723:12:10, 20.68s/it]
  0%|                                                                                                                                                               | 0/2 [00:00<?, ?it/s][Ablank_id: 88
index_motion: torch.Size([128, 196])
(index_motion == blank_id): tensor([[False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        ...,
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True]], device='cuda:0')

 50%|███████████████████████████████████████████████████████████████████████████▌                                                                           | 1/2 [00:09<00:09,  9.57s/it][Ablank_id: 88
index_motion: torch.Size([128, 196])
(index_motion == blank_id): tensor([[False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        ...,
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True],
        [False, False, False,  ...,  True,  True,  True]], device='cuda:0')

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:19<00:00,  9.50s/it][A100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:19<00:00,  9.58s/it]
2023-03-29 22:14:17,102 INFO --> 	 Eva. Iter 5 :, FID. 83.4808, Diversity Real. 11.8752, Diversity. 1.6261, R_precision_real. [0.171875   0.32421875 0.4296875 ], R_precision. [0.0078125  0.01953125 0.0234375 ], matching_score_real. 2.615750312805176, matching_score_pred. 9.593554973602295
  0%|                                                                                                                                             | 4/300000 [01:23<1732:16:29, 20.79s/it]
  0%|                                                                                                                                                               | 0/2 [00:00<?, ?it/s][A^C  0%|                                                                                                                                                               | 0/2 [00:02<?, ?it/s]
  0%|                                                                                                                                             | 4/300000 [01:27<1822:11:27, 21.87s/it]
Traceback (most recent call last):
  File "train_t2m_trans.py", line 199, in <module>
    pred_pose_eval, pose, m_length, clip_text, best_fid, best_iter, best_div, best_top1, best_top2, best_top3, best_matching, writer, logger = eval_trans.evaluation_transformer(blank_id, args.out_dir, val_loader, net, trans_encoder, logger, writer, nb_iter, best_fid, best_iter, best_div, best_top1, best_top2, best_top3, best_matching, clip_model=clip_model, eval_wrapper=eval_wrapper)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/epinyoan/git/MaskText2Motion/T2M-BiDirection/utils/eval_trans.py", line 205, in evaluation_transformer
    index_motion = trans(feat_clip_text, False, type="sample")
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/nn/parallel/data_parallel.py", line 167, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/nn/parallel/data_parallel.py", line 177, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/nn/parallel/parallel_apply.py", line 78, in parallel_apply
    thread.join()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/threading.py", line 1011, in join
    self._wait_for_tstate_lock()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/threading.py", line 1027, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt
^CProcess Process-13:
Process Process-12:
Exception ignored in: <module 'threading' from '/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/threading.py'>
Traceback (most recent call last):
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/threading.py", line 1388, in _shutdown
    lock.acquire()
KeyboardInterrupt: 
Traceback (most recent call last):
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/multiprocessing/process.py", line 318, in _bootstrap
    util._exit_function()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/multiprocessing/util.py", line 360, in _exit_function
    _run_finalizers()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/multiprocessing/util.py", line 300, in _run_finalizers
    finalizer()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/multiprocessing/util.py", line 224, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/multiprocessing/queues.py", line 195, in _finalize_join
    thread.join()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/threading.py", line 1011, in join
    self._wait_for_tstate_lock()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/threading.py", line 1027, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/multiprocessing/process.py", line 318, in _bootstrap
    util._exit_function()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/multiprocessing/util.py", line 360, in _exit_function
    _run_finalizers()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/multiprocessing/util.py", line 300, in _run_finalizers
    finalizer()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/multiprocessing/util.py", line 224, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/multiprocessing/queues.py", line 195, in _finalize_join
    thread.join()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/threading.py", line 1011, in join
    self._wait_for_tstate_lock()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/threading.py", line 1027, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/multiprocessing/popen_fork.py", line 27, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 3595) exited unexpectedly with exit code 1. Details are lost due to multiprocessing. Rerunning with num_workers=0 may give better error trace.
^C^C^C^C2023-03-29 22:14:24,421 INFO {
    "batch_size": 128,
    "block_size": 197,
    "clip_dim": 512,
    "code_dim": 32,
    "dataname": "kit",
    "decay_option": "all",
    "depth": 3,
    "dilation_growth_rate": 3,
    "down_t": 2,
    "drop_out_rate": 0.1,
    "embed_dim_gpt": 256,
    "eval_iter": 10000,
    "exp_name": "1_TRANS",
    "ff_rate": 4,
    "fps": [
        20
    ],
    "gamma": 0.05,
    "if_maxtest": false,
    "lr": 0.0001,
    "lr_scheduler": [
        150000
    ],
    "mu": 0.99,
    "n_head_gpt": 16,
    "nb_code": 8192,
    "num_layers": 8,
    "optimizer": "adamw",
    "out_dir": "output_GPT_Final/1_TRANS",
    "output_emb_width": 512,
    "pkeep": 0.5,
    "print_iter": 200,
    "quantbeta": 1.0,
    "quantizer": "ema_reset",
    "resume_pth": "output/VQT_6_cbEmb32x8192_fixQMultiGPU/net_last.pth",
    "resume_trans": null,
    "seed": 123,
    "seq_len": 64,
    "stride_t": 2,
    "total_iter": 300000,
    "vq_act": "relu",
    "vq_dir": "output/VQT_6_cbEmb32x8192_fixQMultiGPU",
    "vq_name": "VQT_6_cbEmb32x8192_fixQMultiGPU",
    "warm_up_iter": 1000,
    "weight_decay": 1e-06,
    "width": 512
}
  0%|                                                                                                                                                            | 0/4888 [00:00<?, ?it/s]  5%|███████▋                                                                                                                                        | 261/4888 [00:00<00:01, 2609.63it/s] 13%|███████████████████▏                                                                                                                            | 652/4888 [00:00<00:01, 3373.27it/s] 21%|██████████████████████████████▎                                                                                                                | 1034/4888 [00:00<00:01, 3577.10it/s] 29%|█████████████████████████████████████████▋                                                                                                     | 1426/4888 [00:00<00:00, 3710.71it/s] 37%|█████████████████████████████████████████████████████▍                                                                                         | 1826/4888 [00:00<00:00, 3813.05it/s] 45%|████████████████████████████████████████████████████████████████▉                                                                              | 2219/4888 [00:00<00:00, 3851.56it/s] 53%|████████████████████████████████████████████████████████████████████████████▍                                                                  | 2611/4888 [00:00<00:00, 3872.83it/s] 61%|███████████████████████████████████████████████████████████████████████████████████████▉                                                       | 3004/4888 [00:00<00:00, 3890.21it/s] 69%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                           | 3397/4888 [00:00<00:00, 3898.14it/s] 77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                | 3787/4888 [00:01<00:00, 3860.17it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 4178/4888 [00:01<00:00, 3875.06it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋         | 4569/4888 [00:01<00:00, 3885.20it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4888/4888 [00:01<00:00, 3797.23it/s]
  0%|                                                                                                                                                             | 0/300 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 300/300 [00:00<00:00, 3208.94it/s]
Pointer Pointing at 0
Reading checkpoints/kit/Comp_v6_KLD005/opt.txt
Loading Evaluation Model Wrapper (Epoch 30) Completed!!
loading checkpoint from output/VQT_6_cbEmb32x8192_fixQMultiGPU/net_last.pth
  0%|                                                                                                                                                            | 0/4888 [00:00<?, ?it/s]  6%|████████▉                                                                                                                                       | 305/4888 [00:00<00:01, 3040.67it/s] 13%|██████████████████▌                                                                                                                             | 630/4888 [00:00<00:01, 3163.09it/s] 22%|███████████████████████████████▋                                                                                                               | 1083/4888 [00:00<00:01, 3785.77it/s] 30%|██████████████████████████████████████████▊                                                                                                    | 1462/4888 [00:00<00:00, 3500.56it/s] 40%|█████████████████████████████████████████████████████████▎                                                                                     | 1959/4888 [00:00<00:00, 4002.39it/s] 51%|████████████████████████████████████████████████████████████████████████▋                                                                      | 2484/4888 [00:00<00:00, 4409.79it/s] 60%|█████████████████████████████████████████████████████████████████████████████████████▋                                                         | 2930/4888 [00:00<00:00, 4293.74it/s] 71%|████████████████████████████████████████████████████████████████████████████████████████████████████▉                                          | 3449/4888 [00:00<00:00, 4567.36it/s] 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                          | 3985/4888 [00:00<00:00, 4808.74it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 4519/4888 [00:01<00:00, 4966.96it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4888/4888 [00:01<00:00, 4441.82it/s]
  0%|                                                                                                                                                          | 0/300000 [00:00<?, ?it/s]
  0%|                                                                                                                                                               | 0/2 [00:00<?, ?it/s][A
 50%|███████████████████████████████████████████████████████████████████████████▌                                                                           | 1/2 [00:10<00:10, 10.13s/it][A
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:18<00:00,  9.19s/it][A100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:18<00:00,  9.40s/it]
2023-03-29 22:15:06,879 INFO --> 	 Eva. Iter 2 :, FID. 100.4070, Diversity Real. 11.2750, Diversity. 4.1371, R_precision_real. [0.15234375 0.2734375  0.38671875], R_precision. [0.         0.0078125  0.01171875], matching_score_real. 2.7430994510650635, matching_score_pred. 11.838963031768799
2023-03-29 22:15:06,880 INFO --> --> 	 FID Improved from 1000.00000 to 100.40698 !!!
2023-03-29 22:15:07,057 INFO --> --> 	 matching_score Improved from 100.00000 to 11.83896 !!!
2023-03-29 22:15:07,057 INFO --> --> 	 Diversity Improved from 100.00000 to 4.13715 !!!
2023-03-29 22:15:07,058 INFO --> --> 	 Top2 Improved from 0.0000 to 0.0078 !!!
2023-03-29 22:15:07,058 INFO --> --> 	 Top3 Improved from 0.0000 to 0.0117 !!!
^C  0%|                                                                                                                                                          | 0/300000 [00:25<?, ?it/s]
Traceback (most recent call last):
  File "train_t2m_trans.py", line 205, in <module>
    visualize_2motions(x, val_loader.dataset.std, val_loader.dataset.mean, args.dataname, l, y, save_path=f'{args.out_dir}/html/{str(nb_iter)}_{caption}_{l}.html')
  File "/home/epinyoan/git/MaskText2Motion/T2M-BiDirection/exit/utils.py", line 48, in visualize_2motions
    animate3d(joint_original_forward[:length]*scale, 
  File "/home/epinyoan/git/MaskText2Motion/T2M-BiDirection/exit/utils.py", line 147, in animate3d
    update_trace(0)
  File "/home/epinyoan/git/MaskText2Motion/T2M-BiDirection/exit/utils.py", line 128, in update_trace
    fig.update_traces(x=display_points[k, :first_total_standard, 0],
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/plotly/graph_objs/_figure.py", line 745, in update_traces
    return super(Figure, self).update_traces(
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/plotly/basedatatypes.py", line 1366, in update_traces
    trace.update(patch, overwrite=overwrite, **kwargs)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/plotly/basedatatypes.py", line 5114, in update
    BaseFigure._perform_update(self, kwargs, overwrite=overwrite)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/plotly/basedatatypes.py", line 3865, in _perform_update
    err = _check_path_in_prop_tree(plotly_obj, key, error_cast=ValueError)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/plotly/basedatatypes.py", line 180, in _check_path_in_prop_tree
    prop, prop_idcs = _str_to_dict_path_full(path)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/plotly/basedatatypes.py", line 107, in _str_to_dict_path_full
    reduce(
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/plotly/basedatatypes.py", line 100, in _split_and_chomp
    s_chomped = chomp_empty_strings(s_split, "_", reverse=True)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/_plotly_utils/utils.py", line 405, in chomp_empty_strings
    return _rev(chomp_empty_strings(_rev(strings), c))
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/_plotly_utils/utils.py", line 425, in chomp_empty_strings
    return list(filter(len, reduce(_Chomper(c), strings, [""])))
KeyboardInterrupt
2023-03-29 22:20:12,312 INFO {
    "batch_size": 128,
    "block_size": 197,
    "clip_dim": 512,
    "code_dim": 32,
    "dataname": "kit",
    "decay_option": "all",
    "depth": 3,
    "dilation_growth_rate": 3,
    "down_t": 2,
    "drop_out_rate": 0.1,
    "embed_dim_gpt": 256,
    "eval_iter": 10000,
    "exp_name": "1_TRANS",
    "ff_rate": 4,
    "fps": [
        20
    ],
    "gamma": 0.05,
    "if_maxtest": false,
    "lr": 0.0001,
    "lr_scheduler": [
        150000
    ],
    "mu": 0.99,
    "n_head_gpt": 16,
    "nb_code": 8192,
    "num_layers": 8,
    "optimizer": "adamw",
    "out_dir": "output_GPT_Final/1_TRANS",
    "output_emb_width": 512,
    "pkeep": 0.5,
    "print_iter": 200,
    "quantbeta": 1.0,
    "quantizer": "ema_reset",
    "resume_pth": "output/VQT_6_cbEmb32x8192_fixQMultiGPU/net_last.pth",
    "resume_trans": null,
    "seed": 123,
    "seq_len": 64,
    "stride_t": 2,
    "total_iter": 300000,
    "vq_act": "relu",
    "vq_dir": "output/VQT_6_cbEmb32x8192_fixQMultiGPU",
    "vq_name": "VQT_6_cbEmb32x8192_fixQMultiGPU",
    "warm_up_iter": 1000,
    "weight_decay": 1e-06,
    "width": 512
}
  0%|                                                                                                                                                            | 0/4888 [00:00<?, ?it/s]  6%|███████▉                                                                                                                                        | 271/4888 [00:00<00:01, 2707.89it/s] 14%|███████████████████▋                                                                                                                            | 668/4888 [00:00<00:01, 3446.10it/s] 22%|██████████████████████████████▉                                                                                                                | 1056/4888 [00:00<00:01, 3642.10it/s] 30%|██████████████████████████████████████████▌                                                                                                    | 1453/4888 [00:00<00:00, 3760.08it/s] 38%|██████████████████████████████████████████████████████▌                                                                                        | 1863/4888 [00:00<00:00, 3879.88it/s] 46%|██████████████████████████████████████████████████████████████████                                                                             | 2256/4888 [00:00<00:00, 3896.29it/s] 54%|█████████████████████████████████████████████████████████████████████████████▍                                                                 | 2647/4888 [00:00<00:00, 3899.53it/s] 62%|█████████████████████████████████████████████████████████████████████████████████████████                                                      | 3045/4888 [00:00<00:00, 3923.83it/s] 70%|████████████████████████████████████████████████████████████████████████████████████████████████████▌                                          | 3438/4888 [00:00<00:00, 3895.12it/s] 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 3834/4888 [00:01<00:00, 3912.47it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   | 4238/4888 [00:01<00:00, 3951.04it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋       | 4636/4888 [00:01<00:00, 3959.62it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4888/4888 [00:01<00:00, 3855.91it/s]
  0%|                                                                                                                                                             | 0/300 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 300/300 [00:00<00:00, 3298.28it/s]
Pointer Pointing at 0
Reading checkpoints/kit/Comp_v6_KLD005/opt.txt
Loading Evaluation Model Wrapper (Epoch 30) Completed!!
loading checkpoint from output/VQT_6_cbEmb32x8192_fixQMultiGPU/net_last.pth
  0%|                                                                                                                                                            | 0/4888 [00:00<?, ?it/s]  6%|█████████▎                                                                                                                                      | 315/4888 [00:00<00:01, 3146.20it/s] 13%|██████████████████▉                                                                                                                             | 644/4888 [00:00<00:01, 3227.84it/s] 22%|████████████████████████████████                                                                                                               | 1097/4888 [00:00<00:00, 3819.76it/s] 30%|███████████████████████████████████████████▎                                                                                                   | 1479/4888 [00:00<00:00, 3678.24it/s] 41%|██████████████████████████████████████████████████████████▊                                                                                    | 2010/4888 [00:00<00:00, 4251.85it/s] 52%|██████████████████████████████████████████████████████████████████████████▍                                                                    | 2545/4888 [00:00<00:00, 4618.56it/s] 63%|██████████████████████████████████████████████████████████████████████████████████████████▌                                                    | 3097/4888 [00:00<00:00, 4907.11it/s] 74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                     | 3620/4888 [00:00<00:00, 5007.46it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                     | 4157/4888 [00:00<00:00, 5118.67it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏     | 4689/4888 [00:01<00:00, 5180.45it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4888/4888 [00:01<00:00, 4665.07it/s]
  0%|                                                                                                                                                          | 0/300000 [00:00<?, ?it/s]  0%|                                                                                                                                              | 1/300000 [00:02<185:37:24,  2.23s/it]  0%|                                                                                                                                              | 2/300000 [00:03<134:16:22,  1.61s/it]  0%|                                                                                                                                              | 3/300000 [00:04<118:49:26,  1.43s/it]  0%|                                                                                                                                              | 4/300000 [00:05<111:49:42,  1.34s/it]  0%|                                                                                                                                              | 5/300000 [00:07<112:06:45,  1.35s/it]  0%|                                                                                                                                              | 5/300000 [00:07<119:37:54,  1.44s/it]
Traceback (most recent call last):
  File "train_t2m_trans.py", line 134, in <module>
    batch = next(train_loader_iter)
  File "/home/epinyoan/git/MaskText2Motion/T2M-BiDirection/dataset/dataset_TM_train.py", line 159, in cycle
    for x in iterable:
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1179, in _next_data
    return self._process_data(data)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1225, in _process_data
    data.reraise()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/_utils.py", line 429, in reraise
    raise self.exc_type(msg)
RuntimeError: Caught RuntimeError in DataLoader worker process 5.
Original Traceback (most recent call last):
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 202, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 47, in fetch
    return self.collate_fn(data)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 83, in default_collate
    return [default_collate(samples) for samples in transposed]
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 83, in <listcomp>
    return [default_collate(samples) for samples in transposed]
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 63, in default_collate
    return default_collate([torch.as_tensor(b) for b in batch])
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 55, in default_collate
    return torch.stack(batch, 0, out=out)
RuntimeError: stack expects each tensor to be equal size, but got [196] at entry 0 and [197] at entry 17

^C2023-03-29 22:21:59,962 INFO {
    "batch_size": 128,
    "block_size": 197,
    "clip_dim": 512,
    "code_dim": 32,
    "dataname": "kit",
    "decay_option": "all",
    "depth": 3,
    "dilation_growth_rate": 3,
    "down_t": 2,
    "drop_out_rate": 0.1,
    "embed_dim_gpt": 256,
    "eval_iter": 10000,
    "exp_name": "1_TRANS",
    "ff_rate": 4,
    "fps": [
        20
    ],
    "gamma": 0.05,
    "if_maxtest": false,
    "lr": 0.0001,
    "lr_scheduler": [
        150000
    ],
    "mu": 0.99,
    "n_head_gpt": 16,
    "nb_code": 8192,
    "num_layers": 8,
    "optimizer": "adamw",
    "out_dir": "output_GPT_Final/1_TRANS",
    "output_emb_width": 512,
    "pkeep": 0.5,
    "print_iter": 200,
    "quantbeta": 1.0,
    "quantizer": "ema_reset",
    "resume_pth": "output/VQT_6_cbEmb32x8192_fixQMultiGPU/net_last.pth",
    "resume_trans": null,
    "seed": 123,
    "seq_len": 64,
    "stride_t": 2,
    "total_iter": 300000,
    "vq_act": "relu",
    "vq_dir": "output/VQT_6_cbEmb32x8192_fixQMultiGPU",
    "vq_name": "VQT_6_cbEmb32x8192_fixQMultiGPU",
    "warm_up_iter": 1000,
    "weight_decay": 1e-06,
    "width": 512
}
  0%|                                                                                                                                                            | 0/4888 [00:00<?, ?it/s]  5%|███████▋                                                                                                                                        | 263/4888 [00:00<00:01, 2625.52it/s] 13%|███████████████████▏                                                                                                                            | 651/4888 [00:00<00:01, 3359.84it/s] 21%|██████████████████████████████                                                                                                                 | 1029/4888 [00:00<00:01, 3550.08it/s] 29%|█████████████████████████████████████████▏                                                                                                     | 1409/4888 [00:00<00:00, 3647.84it/s] 37%|████████████████████████████████████████████████████▊                                                                                          | 1805/4888 [00:00<00:00, 3755.63it/s] 45%|████████████████████████████████████████████████████████████████▎                                                                              | 2198/4888 [00:00<00:00, 3812.81it/s] 53%|███████████████████████████████████████████████████████████████████████████▋                                                                   | 2587/4888 [00:00<00:00, 3836.82it/s] 61%|███████████████████████████████████████████████████████████████████████████████████████▏                                                       | 2980/4888 [00:00<00:00, 3864.08it/s] 69%|██████████████████████████████████████████████████████████████████████████████████████████████████▋                                            | 3373/4888 [00:00<00:00, 3884.52it/s] 77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████                                 | 3762/4888 [00:01<00:00, 3842.44it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                     | 4152/4888 [00:01<00:00, 3859.09it/s] 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 4543/4888 [00:01<00:00, 3873.98it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4888/4888 [00:01<00:00, 3780.19it/s]
  0%|                                                                                                                                                             | 0/300 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 300/300 [00:00<00:00, 3211.90it/s]
Pointer Pointing at 0
Reading checkpoints/kit/Comp_v6_KLD005/opt.txt
Loading Evaluation Model Wrapper (Epoch 30) Completed!!
loading checkpoint from output/VQT_6_cbEmb32x8192_fixQMultiGPU/net_last.pth
  0%|                                                                                                                                                            | 0/4888 [00:00<?, ?it/s]  6%|████████▊                                                                                                                                       | 298/4888 [00:00<00:01, 2973.40it/s] 13%|██████████████████▎                                                                                                                             | 620/4888 [00:00<00:01, 3114.89it/s] 19%|███████████████████████████▍                                                                                                                    | 932/4888 [00:00<00:01, 3097.17it/s] 28%|████████████████████████████████████████▎                                                                                                      | 1379/4888 [00:00<00:01, 2830.60it/s] 39%|███████████████████████████████████████████████████████                                                                                        | 1884/4888 [00:00<00:00, 3504.09it/s] 49%|█████████████████████████████████████████████████████████████████████▊                                                                         | 2388/4888 [00:00<00:00, 3968.81it/s] 59%|████████████████████████████████████████████████████████████████████████████████████▉                                                          | 2905/4888 [00:00<00:00, 4329.63it/s] 70%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                           | 3416/4888 [00:00<00:00, 4562.18it/s] 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                            | 3924/4888 [00:00<00:00, 4716.38it/s] 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌             | 4428/4888 [00:01<00:00, 4810.91it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4888/4888 [00:01<00:00, 4192.87it/s]
  0%|                                                                                                                                                          | 0/300000 [00:00<?, ?it/s]  0%|                                                                                                                                              | 1/300000 [00:02<182:54:44,  2.19s/it]  0%|                                                                                                                                              | 2/300000 [00:03<136:30:59,  1.64s/it]  0%|                                                                                                                                              | 3/300000 [00:04<120:50:20,  1.45s/it]  0%|                                                                                                                                              | 4/300000 [00:05<114:05:37,  1.37s/it]  0%|                                                                                                                                              | 5/300000 [00:07<112:47:16,  1.35s/it]  0%|                                                                                                                                              | 6/300000 [00:08<108:57:57,  1.31s/it]  0%|                                                                                                                                              | 7/300000 [00:09<106:28:42,  1.28s/it]  0%|                                                                                                                                              | 8/300000 [00:10<104:51:10,  1.26s/it]  0%|                                                                                                                                              | 9/300000 [00:12<103:39:06,  1.24s/it]  0%|                                                                                                                                             | 10/300000 [00:13<102:54:44,  1.23s/it]  0%|                                                                                                                                             | 11/300000 [00:14<102:18:31,  1.23s/it]  0%|                                                                                                                                             | 12/300000 [00:15<101:55:02,  1.22s/it]  0%|                                                                                                                                             | 13/300000 [00:16<100:32:53,  1.21s/it]  0%|                                                                                                                                              | 14/300000 [00:18<99:35:30,  1.20s/it]  0%|                                                                                                                                              | 15/300000 [00:19<98:59:55,  1.19s/it]  0%|                                                                                                                                              | 16/300000 [00:20<99:48:15,  1.20s/it]  0%|                                                                                                                                              | 17/300000 [00:21<99:21:00,  1.19s/it]  0%|                                                                                                                                             | 18/300000 [00:22<100:00:14,  1.20s/it]  0%|                                                                                                                                             | 19/300000 [00:24<100:22:46,  1.20s/it]  0%|                                                                                                                                             | 20/300000 [00:25<100:43:07,  1.21s/it]  0%|                                                                                                                                             | 21/300000 [00:26<100:54:37,  1.21s/it]  0%|                                                                                                                                             | 22/300000 [00:27<101:00:16,  1.21s/it]  0%|                                                                                                                                             | 23/300000 [00:28<101:07:07,  1.21s/it]  0%|                                                                                                                                             | 24/300000 [00:30<101:09:29,  1.21s/it]  0%|                                                                                                                                             | 25/300000 [00:31<100:31:42,  1.21s/it]  0%|                                                                                                                                              | 26/300000 [00:32<99:33:16,  1.19s/it]  0%|                                                                                                                                              | 27/300000 [00:33<98:49:32,  1.19s/it]  0%|                                                                                                                                              | 28/300000 [00:34<98:17:44,  1.18s/it]  0%|                                                                                                                                              | 29/300000 [00:36<97:40:54,  1.17s/it]  0%|                                                                                                                                              | 30/300000 [00:37<97:20:44,  1.17s/it]  0%|                                                                                                                                              | 31/300000 [00:38<97:10:16,  1.17s/it]  0%|                                                                                                                                              | 32/300000 [00:39<97:10:35,  1.17s/it]  0%|                                                                                                                                              | 33/300000 [00:40<96:56:51,  1.16s/it]  0%|                                                                                                                                              | 34/300000 [00:41<97:02:48,  1.16s/it]  0%|                                                                                                                                             | 35/300000 [00:43<118:38:57,  1.42s/it]  0%|                                                                                                                                             | 36/300000 [00:45<113:20:06,  1.36s/it]  0%|                                                                                                                                             | 37/300000 [00:46<108:10:54,  1.30s/it]  0%|                                                                                                                                             | 38/300000 [00:47<105:09:01,  1.26s/it]  0%|                                                                                                                                             | 39/300000 [00:48<103:43:46,  1.24s/it]  0%|                                                                                                                                             | 40/300000 [00:49<101:42:50,  1.22s/it]  0%|                                                                                                                                             | 41/300000 [00:50<100:29:00,  1.21s/it]  0%|                                                                                                                                              | 42/300000 [00:52<99:11:58,  1.19s/it]  0%|                                                                                                                                             | 43/300000 [00:53<100:36:02,  1.21s/it]  0%|                                                                                                                                              | 44/300000 [00:54<99:20:18,  1.19s/it]  0%|                                                                                                                                              | 45/300000 [00:55<98:41:58,  1.18s/it]  0%|                                                                                                                                              | 46/300000 [00:56<98:08:48,  1.18s/it]  0%|                                                                                                                                              | 47/300000 [00:57<97:49:43,  1.17s/it]  0%|                                                                                                                                              | 48/300000 [00:59<97:28:06,  1.17s/it]  0%|                                                                                                                                              | 49/300000 [01:00<97:30:13,  1.17s/it]  0%|                                                                                                                                              | 50/300000 [01:01<98:21:23,  1.18s/it]  0%|                                                                                                                                              | 51/300000 [01:02<97:42:35,  1.17s/it]  0%|                                                                                                                                              | 52/300000 [01:03<97:42:51,  1.17s/it]  0%|                                                                                                                                              | 53/300000 [01:05<99:36:57,  1.20s/it]  0%|                                                                                                                                              | 54/300000 [01:06<98:32:35,  1.18s/it]  0%|                                                                                                                                              | 55/300000 [01:07<97:55:37,  1.18s/it]  0%|                                                                                                                                              | 56/300000 [01:08<97:22:01,  1.17s/it]  0%|                                                                                                                                              | 57/300000 [01:09<97:21:25,  1.17s/it]  0%|                                                                                                                                              | 58/300000 [01:10<97:14:40,  1.17s/it]  0%|                                                                                                                                              | 59/300000 [01:12<97:24:54,  1.17s/it]  0%|                                                                                                                                              | 60/300000 [01:13<98:31:35,  1.18s/it]  0%|                                                                                                                                              | 61/300000 [01:14<98:10:04,  1.18s/it]  0%|                                                                                                                                              | 62/300000 [01:15<97:49:44,  1.17s/it]  0%|                                                                                                                                              | 63/300000 [01:16<97:33:40,  1.17s/it]  0%|                                                                                                                                              | 64/300000 [01:17<98:40:39,  1.18s/it]  0%|                                                                                                                                              | 65/300000 [01:19<98:11:06,  1.18s/it]  0%|                                                                                                                                              | 66/300000 [01:20<97:48:18,  1.17s/it]  0%|                                                                                                                                              | 67/300000 [01:21<97:34:34,  1.17s/it]  0%|                                                                                                                                              | 68/300000 [01:22<97:23:00,  1.17s/it]  0%|                                                                                                                                             | 69/300000 [01:24<118:14:40,  1.42s/it]  0%|                                                                                                                                             | 70/300000 [01:25<113:22:38,  1.36s/it]  0%|                                                                                                                                             | 71/300000 [01:27<108:19:03,  1.30s/it]  0%|                                                                                                                                             | 72/300000 [01:28<105:26:57,  1.27s/it]  0%|                                                                                                                                             | 73/300000 [01:29<104:17:04,  1.25s/it]  0%|                                                                                                                                             | 74/300000 [01:30<102:49:02,  1.23s/it]  0%|                                                                                                                                             | 75/300000 [01:31<100:58:33,  1.21s/it]  0%|                                                                                                                                              | 76/300000 [01:32<99:53:52,  1.20s/it]  0%|                                                                                                                                              | 77/300000 [01:34<99:17:20,  1.19s/it]  0%|                                                                                                                                             | 78/300000 [01:35<100:17:53,  1.20s/it]  0%|                                                                                                                                              | 79/300000 [01:36<99:32:39,  1.19s/it]  0%|                                                                                                                                             | 80/300000 [01:37<100:12:20,  1.20s/it]  0%|                                                                                                                                              | 81/300000 [01:38<99:25:44,  1.19s/it]  0%|                                                                                                                                              | 82/300000 [01:40<98:25:02,  1.18s/it]  0%|                                                                                                                                              | 83/300000 [01:41<97:52:29,  1.17s/it]  0%|                                                                                                                                              | 84/300000 [01:42<97:41:30,  1.17s/it]  0%|                                                                                                                                              | 85/300000 [01:43<97:12:49,  1.17s/it]  0%|                                                                                                                                              | 86/300000 [01:44<97:24:53,  1.17s/it]  0%|                                                                                                                                              | 87/300000 [01:45<97:59:18,  1.18s/it]  0%|                                                                                                                                              | 88/300000 [01:47<97:41:31,  1.17s/it]  0%|                                                                                                                                              | 89/300000 [01:48<97:59:40,  1.18s/it]  0%|                                                                                                                                              | 90/300000 [01:49<98:00:11,  1.18s/it]  0%|                                                                                                                                              | 91/300000 [01:50<98:51:46,  1.19s/it]  0%|                                                                                                                                              | 92/300000 [01:51<98:12:28,  1.18s/it]  0%|                                                                                                                                              | 93/300000 [01:53<98:06:02,  1.18s/it]  0%|                                                                                                                                              | 94/300000 [01:54<98:42:40,  1.18s/it]  0%|                                                                                                                                              | 95/300000 [01:55<98:26:26,  1.18s/it]  0%|                                                                                                                                              | 96/300000 [01:56<98:02:20,  1.18s/it]  0%|                                                                                                                                              | 97/300000 [01:57<97:52:21,  1.17s/it]  0%|                                                                                                                                              | 98/300000 [01:58<97:36:18,  1.17s/it]  0%|                                                                                                                                              | 99/300000 [02:00<97:14:05,  1.17s/it]  0%|                                                                                                                                             | 100/300000 [02:01<97:31:27,  1.17s/it]  0%|                                                                                                                                             | 101/300000 [02:02<97:33:55,  1.17s/it]  0%|                                                                                                                                             | 102/300000 [02:03<97:12:49,  1.17s/it]  0%|                                                                                                                                            | 103/300000 [02:05<119:45:44,  1.44s/it]  0%|                                                                                                                                            | 104/300000 [02:06<117:03:53,  1.41s/it]  0%|                                                                                                                                            | 105/300000 [02:08<112:24:34,  1.35s/it]  0%|                                                                                                                                            | 106/300000 [02:09<109:03:18,  1.31s/it]  0%|                                                                                                                                            | 107/300000 [02:10<106:47:50,  1.28s/it]  0%|                                                                                                                                            | 108/300000 [02:11<105:07:01,  1.26s/it]  0%|                                                                                                                                            | 109/300000 [02:13<104:14:45,  1.25s/it]  0%|                                                                                                                                            | 110/300000 [02:14<103:14:31,  1.24s/it]  0%|                                                                                                                                            | 111/300000 [02:15<101:13:58,  1.22s/it]  0%|                                                                                                                                             | 112/300000 [02:16<99:44:10,  1.20s/it]  0%|                                                                                                                                             | 113/300000 [02:17<98:54:14,  1.19s/it]  0%|                                                                                                                                             | 114/300000 [02:18<98:03:21,  1.18s/it]  0%|                                                                                                                                            | 115/300000 [02:20<100:05:19,  1.20s/it]  0%|                                                                                                                                             | 116/300000 [02:21<99:09:11,  1.19s/it]  0%|                                                                                                                                             | 117/300000 [02:22<98:18:40,  1.18s/it]  0%|                                                                                                                                             | 118/300000 [02:23<97:55:26,  1.18s/it]  0%|                                                                                                                                             | 119/300000 [02:24<97:26:09,  1.17s/it]  0%|                                                                                                                                             | 120/300000 [02:25<97:32:13,  1.17s/it]  0%|                                                                                                                                             | 121/300000 [02:27<98:14:00,  1.18s/it]  0%|                                                                                                                                             | 122/300000 [02:28<97:48:50,  1.17s/it]  0%|                                                                                                                                             | 123/300000 [02:29<97:44:05,  1.17s/it]  0%|                                                                                                                                             | 124/300000 [02:30<97:32:05,  1.17s/it]  0%|                                                                                                                                             | 125/300000 [02:31<97:23:34,  1.17s/it]  0%|                                                                                                                                             | 126/300000 [02:33<98:20:54,  1.18s/it]  0%|                                                                                                                                             | 127/300000 [02:34<98:12:14,  1.18s/it]  0%|                                                                                                                                             | 128/300000 [02:35<98:54:33,  1.19s/it]  0%|                                                                                                                                             | 129/300000 [02:36<99:42:09,  1.20s/it]  0%|                                                                                                                                            | 130/300000 [02:37<100:12:06,  1.20s/it]  0%|                                                                                                                                            | 131/300000 [02:39<100:34:26,  1.21s/it]  0%|                                                                                                                                            | 132/300000 [02:40<100:48:20,  1.21s/it]  0%|                                                                                                                                            | 133/300000 [02:41<100:57:36,  1.21s/it]  0%|                                                                                                                                            | 134/300000 [02:42<100:57:48,  1.21s/it]  0%|                                                                                                                                            | 135/300000 [02:43<101:02:04,  1.21s/it]  0%|                                                                                                                                            | 136/300000 [02:45<101:09:26,  1.21s/it]  0%|                                                                                                                                            | 137/300000 [02:47<120:18:55,  1.44s/it]  0%|                                                                                                                                            | 138/300000 [02:48<113:17:59,  1.36s/it]  0%|                                                                                                                                            | 139/300000 [02:49<108:47:00,  1.31s/it]  0%|                                                                                                                                            | 140/300000 [02:50<105:26:21,  1.27s/it]  0%|                                                                                                                                            | 141/300000 [02:51<104:15:11,  1.25s/it]  0%|                                                                                                                                            | 142/300000 [02:53<102:44:24,  1.23s/it]  0%|                                                                                                                                            | 143/300000 [02:54<101:03:20,  1.21s/it]  0%|                                                                                                                                             | 144/300000 [02:55<99:50:50,  1.20s/it]  0%|                                                                                                                                             | 145/300000 [02:56<98:43:19,  1.19s/it]  0%|                                                                                                                                             | 146/300000 [02:57<98:07:10,  1.18s/it]  0%|                                                                                                                                             | 147/300000 [02:58<97:56:03,  1.18s/it]  0%|                                                                                                                                             | 148/300000 [03:00<98:14:02,  1.18s/it]  0%|                                                                                                                                             | 149/300000 [03:01<98:23:57,  1.18s/it]  0%|                                                                                                                                             | 150/300000 [03:02<97:41:58,  1.17s/it]  0%|                                                                                                                                             | 151/300000 [03:03<97:14:38,  1.17s/it]  0%|                                                                                                                                             | 152/300000 [03:04<96:55:36,  1.16s/it]  0%|                                                                                                                                             | 153/300000 [03:05<96:51:30,  1.16s/it]  0%|                                                                                                                                             | 154/300000 [03:07<97:03:30,  1.17s/it]  0%|                                                                                                                                             | 155/300000 [03:08<97:57:18,  1.18s/it]  0%|                                                                                                                                             | 156/300000 [03:09<97:31:49,  1.17s/it]  0%|                                                                                                                                             | 157/300000 [03:10<97:07:26,  1.17s/it]  0%|                                                                                                                                             | 158/300000 [03:11<96:59:04,  1.16s/it]  0%|                                                                                                                                             | 159/300000 [03:12<96:48:38,  1.16s/it]  0%|                                                                                                                                             | 160/300000 [03:14<98:31:47,  1.18s/it]  0%|                                                                                                                                             | 161/300000 [03:15<98:10:16,  1.18s/it]  0%|                                                                                                                                             | 162/300000 [03:16<98:55:04,  1.19s/it]  0%|                                                                                                                                             | 163/300000 [03:17<99:36:01,  1.20s/it]  0%|                                                                                                                                             | 164/300000 [03:18<99:54:46,  1.20s/it]  0%|                                                                                                                                             | 165/300000 [03:20<98:55:42,  1.19s/it]  0%|                                                                                                                                             | 166/300000 [03:21<98:19:35,  1.18s/it]  0%|                                                                                                                                             | 167/300000 [03:22<98:02:16,  1.18s/it]  0%|                                                                                                                                             | 168/300000 [03:23<99:05:07,  1.19s/it]  0%|                                                                                                                                             | 169/300000 [03:24<99:49:26,  1.20s/it]  0%|                                                                                                                                            | 170/300000 [03:26<101:58:11,  1.22s/it]  0%|                                                                                                                                            | 171/300000 [03:28<120:40:43,  1.45s/it]  0%|                                                                                                                                            | 172/300000 [03:29<113:42:55,  1.37s/it]  0%|                                                                                                                                            | 173/300000 [03:30<109:59:35,  1.32s/it]  0%|                                                                                                                                            | 174/300000 [03:31<107:19:43,  1.29s/it]  0%|                                                                                                                                            | 175/300000 [03:32<105:28:44,  1.27s/it]  0%|                                                                                                                                            | 176/300000 [03:34<104:06:44,  1.25s/it]  0%|                                                                                                                                            | 177/300000 [03:35<103:10:06,  1.24s/it]  0%|                                                                                                                                            | 178/300000 [03:36<102:47:31,  1.23s/it]  0%|                                                                                                                                            | 179/300000 [03:37<102:17:39,  1.23s/it]  0%|                                                                                                                                            | 180/300000 [03:38<101:59:33,  1.22s/it]  0%|                                                                                                                                            | 181/300000 [03:40<103:22:41,  1.24s/it]  0%|                                                                                                                                            | 182/300000 [03:41<102:40:52,  1.23s/it]  0%|                                                                                                                                            | 183/300000 [03:42<102:21:39,  1.23s/it]  0%|                                                                                                                                            | 184/300000 [03:43<102:06:35,  1.23s/it]  0%|                                                                                                                                            | 185/300000 [03:45<101:49:32,  1.22s/it]  0%|                                                                                                                                            | 186/300000 [03:46<100:45:57,  1.21s/it]  0%|                                                                                                                                             | 187/300000 [03:47<99:51:34,  1.20s/it]  0%|                                                                                                                                            | 188/300000 [03:48<100:30:01,  1.21s/it]  0%|                                                                                                                                             | 189/300000 [03:49<99:30:30,  1.19s/it]  0%|                                                                                                                                             | 190/300000 [03:51<98:51:30,  1.19s/it]^C  0%|                                                                                                                                            | 190/300000 [03:51<101:19:17,  1.22s/it]
Traceback (most recent call last):
  File "train_t2m_trans.py", line 158, in <module>
    cls_pred = trans_encoder(a_indices, feat_clip_text)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/nn/parallel/data_parallel.py", line 167, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/nn/parallel/data_parallel.py", line 177, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/nn/parallel/parallel_apply.py", line 78, in parallel_apply
    thread.join()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/threading.py", line 1011, in join
    self._wait_for_tstate_lock()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/threading.py", line 1027, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt
^C^C^C2023-03-29 22:26:16,128 INFO {
    "batch_size": 128,
    "block_size": 196,
    "clip_dim": 512,
    "code_dim": 32,
    "dataname": "kit",
    "decay_option": "all",
    "depth": 3,
    "dilation_growth_rate": 3,
    "down_t": 2,
    "drop_out_rate": 0.1,
    "embed_dim_gpt": 256,
    "eval_iter": 10000,
    "exp_name": "1_TRANS",
    "ff_rate": 4,
    "fps": [
        20
    ],
    "gamma": 0.05,
    "if_maxtest": false,
    "lr": 0.0001,
    "lr_scheduler": [
        150000
    ],
    "mu": 0.99,
    "n_head_gpt": 16,
    "nb_code": 8192,
    "num_layers": 8,
    "optimizer": "adamw",
    "out_dir": "output_GPT_Final/1_TRANS",
    "output_emb_width": 512,
    "pkeep": 0.5,
    "print_iter": 200,
    "quantbeta": 1.0,
    "quantizer": "ema_reset",
    "resume_pth": "output/VQT_6_cbEmb32x8192_fixQMultiGPU/net_last.pth",
    "resume_trans": null,
    "seed": 123,
    "seq_len": 64,
    "stride_t": 2,
    "total_iter": 300000,
    "vq_act": "relu",
    "vq_dir": "output/VQT_6_cbEmb32x8192_fixQMultiGPU",
    "vq_name": "VQT_6_cbEmb32x8192_fixQMultiGPU",
    "warm_up_iter": 1000,
    "weight_decay": 1e-06,
    "width": 512
}
  0%|                                                                                                                                                            | 0/4888 [00:00<?, ?it/s]  5%|███████▎                                                                                                                                        | 250/4888 [00:00<00:01, 2498.70it/s] 13%|██████████████████▉                                                                                                                             | 644/4888 [00:00<00:01, 3345.67it/s] 21%|██████████████████████████████▎                                                                                                                | 1035/4888 [00:00<00:01, 3599.97it/s] 29%|█████████████████████████████████████████▋                                                                                                     | 1427/4888 [00:00<00:00, 3725.33it/s] 38%|█████████████████████████████████████████████████████▋                                                                                         | 1835/4888 [00:00<00:00, 3850.69it/s] 46%|█████████████████████████████████████████████████████████████████▍                                                                             | 2236/4888 [00:00<00:00, 3901.41it/s] 54%|█████████████████████████████████████████████████████████████████████████████                                                                  | 2636/4888 [00:00<00:00, 3933.36it/s] 62%|████████████████████████████████████████████████████████████████████████████████████████▉                                                      | 3041/4888 [00:00<00:00, 3968.01it/s] 70%|████████████████████████████████████████████████████████████████████████████████████████████████████▌                                          | 3438/4888 [00:00<00:00, 3964.19it/s] 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 3835/4888 [00:01<00:00, 3922.57it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                  | 4244/4888 [00:01<00:00, 3972.98it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉       | 4646/4888 [00:01<00:00, 3984.51it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4888/4888 [00:01<00:00, 3861.71it/s]
  0%|                                                                                                                                                             | 0/300 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 300/300 [00:00<00:00, 3318.47it/s]
Pointer Pointing at 0
Reading checkpoints/kit/Comp_v6_KLD005/opt.txt
Loading Evaluation Model Wrapper (Epoch 30) Completed!!
loading checkpoint from output/VQT_6_cbEmb32x8192_fixQMultiGPU/net_last.pth
  0%|                                                                                                                                                            | 0/4888 [00:00<?, ?it/s]  6%|████████▍                                                                                                                                       | 287/4888 [00:00<00:01, 2860.99it/s] 13%|██████████████████                                                                                                                              | 613/4888 [00:00<00:01, 3089.82it/s] 19%|███████████████████████████▏                                                                                                                    | 922/4888 [00:00<00:01, 3089.29it/s] 28%|████████████████████████████████████████▎                                                                                                      | 1379/4888 [00:00<00:01, 2937.43it/s] 39%|███████████████████████████████████████████████████████▉                                                                                       | 1912/4888 [00:00<00:00, 3680.12it/s] 50%|███████████████████████████████████████████████████████████████████████▍                                                                       | 2440/4888 [00:00<00:00, 4171.19it/s] 61%|███████████████████████████████████████████████████████████████████████████████████████▏                                                       | 2982/4888 [00:00<00:00, 4551.86it/s] 72%|██████████████████████████████████████████████████████████████████████████████████████████████████████▋                                        | 3508/4888 [00:00<00:00, 4765.73it/s] 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                        | 4047/4888 [00:00<00:00, 4954.02it/s] 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊         | 4576/4888 [00:01<00:00, 5053.32it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4888/4888 [00:01<00:00, 4353.02it/s]
  0%|                                                                                                                                                          | 0/300000 [00:00<?, ?it/s]  0%|                                                                                                                                              | 1/300000 [00:02<186:37:11,  2.24s/it]  0%|                                                                                                                                              | 2/300000 [00:03<133:39:34,  1.60s/it]  0%|                                                                                                                                              | 3/300000 [00:04<117:18:23,  1.41s/it]  0%|                                                                                                                                              | 4/300000 [00:05<111:07:45,  1.33s/it]  0%|                                                                                                                                              | 5/300000 [00:07<108:16:18,  1.30s/it]  0%|                                                                                                                                              | 6/300000 [00:08<104:10:13,  1.25s/it]  0%|                                                                                                                                              | 7/300000 [00:09<101:34:58,  1.22s/it]  0%|                                                                                                                                              | 8/300000 [00:10<101:09:26,  1.21s/it]  0%|                                                                                                                                              | 9/300000 [00:11<101:20:01,  1.22s/it]  0%|                                                                                                                                             | 10/300000 [00:12<100:25:27,  1.21s/it]  0%|                                                                                                                                             | 11/300000 [00:14<100:04:48,  1.20s/it]  0%|                                                                                                                                              | 12/300000 [00:15<98:55:05,  1.19s/it]  0%|                                                                                                                                              | 13/300000 [00:16<98:12:23,  1.18s/it]  0%|                                                                                                                                              | 14/300000 [00:17<98:02:49,  1.18s/it]  0%|                                                                                                                                              | 15/300000 [00:18<97:37:39,  1.17s/it]  0%|                                                                                                                                              | 16/300000 [00:20<99:45:16,  1.20s/it]  0%|                                                                                                                                              | 17/300000 [00:21<99:23:40,  1.19s/it]  0%|                                                                                                                                              | 18/300000 [00:22<99:48:07,  1.20s/it]  0%|                                                                                                                                              | 19/300000 [00:23<98:52:27,  1.19s/it]  0%|                                                                                                                                              | 20/300000 [00:24<98:10:55,  1.18s/it]  0%|                                                                                                                                              | 21/300000 [00:25<98:12:50,  1.18s/it]  0%|                                                                                                                                              | 22/300000 [00:27<97:50:11,  1.17s/it]  0%|                                                                                                                                              | 23/300000 [00:28<97:34:09,  1.17s/it]  0%|                                                                                                                                              | 24/300000 [00:29<97:17:57,  1.17s/it]  0%|                                                                                                                                              | 25/300000 [00:30<97:13:05,  1.17s/it]  0%|                                                                                                                                              | 26/300000 [00:31<97:08:17,  1.17s/it]  0%|                                                                                                                                              | 27/300000 [00:32<97:05:36,  1.17s/it]  0%|                                                                                                                                              | 28/300000 [00:34<98:22:44,  1.18s/it]  0%|                                                                                                                                              | 29/300000 [00:35<98:14:04,  1.18s/it]  0%|                                                                                                                                              | 30/300000 [00:36<97:46:38,  1.17s/it]  0%|                                                                                                                                              | 31/300000 [00:37<97:44:50,  1.17s/it]  0%|                                                                                                                                              | 32/300000 [00:38<98:46:48,  1.19s/it]  0%|                                                                                                                                              | 33/300000 [00:40<98:29:45,  1.18s/it]  0%|                                                                                                                                              | 34/300000 [00:41<98:06:15,  1.18s/it]^C  0%|                                                                                                                                             | 34/300000 [00:43<105:46:01,  1.27s/it]
Traceback (most recent call last):
  File "train_t2m_trans.py", line 179, in <module>
    loss_cls.backward()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/autograd/__init__.py", line 145, in backward
    Variable._execution_engine.run_backward(
KeyboardInterrupt
^C2023-03-29 22:27:24,466 INFO {
    "batch_size": 128,
    "block_size": 196,
    "clip_dim": 512,
    "code_dim": 32,
    "dataname": "kit",
    "decay_option": "all",
    "depth": 3,
    "dilation_growth_rate": 3,
    "down_t": 2,
    "drop_out_rate": 0.1,
    "embed_dim_gpt": 256,
    "eval_iter": 10000,
    "exp_name": "1_TRANS",
    "ff_rate": 4,
    "fps": [
        20
    ],
    "gamma": 0.05,
    "if_maxtest": false,
    "lr": 0.0001,
    "lr_scheduler": [
        150000
    ],
    "mu": 0.99,
    "n_head_gpt": 16,
    "nb_code": 8192,
    "num_layers": 8,
    "optimizer": "adamw",
    "out_dir": "output_GPT_Final/1_TRANS",
    "output_emb_width": 512,
    "pkeep": 0.5,
    "print_iter": 200,
    "quantbeta": 1.0,
    "quantizer": "ema_reset",
    "resume_pth": "output/VQT_6_cbEmb32x8192_fixQMultiGPU/net_last.pth",
    "resume_trans": null,
    "seed": 123,
    "seq_len": 64,
    "stride_t": 2,
    "total_iter": 300000,
    "vq_act": "relu",
    "vq_dir": "output/VQT_6_cbEmb32x8192_fixQMultiGPU",
    "vq_name": "VQT_6_cbEmb32x8192_fixQMultiGPU",
    "warm_up_iter": 1000,
    "weight_decay": 1e-06,
    "width": 512
}
  0%|                                                                                                                                                            | 0/4888 [00:00<?, ?it/s]  5%|███████▌                                                                                                                                        | 258/4888 [00:00<00:01, 2579.58it/s] 13%|██████████████████▉                                                                                                                             | 643/4888 [00:00<00:01, 3323.16it/s] 21%|█████████████████████████████▊                                                                                                                 | 1018/4888 [00:00<00:01, 3516.39it/s] 29%|█████████████████████████████████████████▏                                                                                                     | 1406/4888 [00:00<00:00, 3657.04it/s] 37%|████████████████████████████████████████████████████▊                                                                                          | 1805/4888 [00:00<00:00, 3769.13it/s] 45%|████████████████████████████████████████████████████████████████▎                                                                              | 2197/4888 [00:00<00:00, 3820.19it/s] 53%|███████████████████████████████████████████████████████████████████████████▍                                                                   | 2580/4888 [00:00<00:00, 3822.87it/s] 61%|██████████████████████████████████████████████████████████████████████████████████████▉                                                        | 2972/4888 [00:00<00:00, 3850.76it/s] 69%|██████████████████████████████████████████████████████████████████████████████████████████████████▏                                            | 3358/4888 [00:00<00:00, 3808.49it/s] 77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                 | 3742/4888 [00:01<00:00, 3816.14it/s] 84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                      | 4129/4888 [00:01<00:00, 3830.48it/s] 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍          | 4529/4888 [00:01<00:00, 3881.53it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4888/4888 [00:01<00:00, 3767.15it/s]
  0%|                                                                                                                                                             | 0/300 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 300/300 [00:00<00:00, 3150.15it/s]
Pointer Pointing at 0
Reading checkpoints/kit/Comp_v6_KLD005/opt.txt
Loading Evaluation Model Wrapper (Epoch 30) Completed!!
loading checkpoint from output/VQT_6_cbEmb32x8192_fixQMultiGPU/net_last.pth
  0%|                                                                                                                                                            | 0/4888 [00:00<?, ?it/s]  6%|████████▉                                                                                                                                       | 305/4888 [00:00<00:01, 3046.10it/s] 13%|██████████████████▍                                                                                                                             | 625/4888 [00:00<00:01, 3132.89it/s] 19%|███████████████████████████▋                                                                                                                    | 939/4888 [00:00<00:01, 3094.74it/s] 28%|████████████████████████████████████████▎                                                                                                      | 1379/4888 [00:00<00:01, 2821.45it/s] 39%|███████████████████████████████████████████████████████▌                                                                                       | 1900/4888 [00:00<00:00, 3547.51it/s] 49%|██████████████████████████████████████████████████████████████████████▋                                                                        | 2416/4888 [00:00<00:00, 4034.80it/s] 60%|█████████████████████████████████████████████████████████████████████████████████████▉                                                         | 2938/4888 [00:00<00:00, 4390.76it/s] 71%|█████████████████████████████████████████████████████████████████████████████████████████████████████▏                                         | 3458/4888 [00:00<00:00, 4633.26it/s] 81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                          | 3979/4888 [00:00<00:00, 4804.22it/s] 92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍           | 4493/4888 [00:01<00:00, 4904.22it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4888/4888 [00:01<00:00, 4250.49it/s]
  0%|                                                                                                                                                          | 0/300000 [00:00<?, ?it/s]  0%|                                                                                                                                              | 1/300000 [00:02<185:59:02,  2.23s/it]  0%|                                                                                                                                              | 2/300000 [00:03<134:13:24,  1.61s/it]  0%|                                                                                                                                              | 3/300000 [00:04<118:47:17,  1.43s/it]  0%|                                                                                                                                              | 4/300000 [00:05<110:11:10,  1.32s/it]  0%|                                                                                                                                              | 5/300000 [00:07<107:38:37,  1.29s/it]  0%|                                                                                                                                              | 6/300000 [00:08<103:52:21,  1.25s/it]  0%|                                                                                                                                              | 7/300000 [00:09<102:03:36,  1.22s/it]  0%|                                                                                                                                              | 8/300000 [00:10<101:56:06,  1.22s/it]  0%|                                                                                                                                              | 9/300000 [00:11<101:26:09,  1.22s/it]  0%|                                                                                                                                              | 10/300000 [00:12<99:41:10,  1.20s/it]  0%|                                                                                                                                              | 11/300000 [00:14<98:28:11,  1.18s/it]  0%|                                                                                                                                              | 12/300000 [00:15<97:42:56,  1.17s/it]  0%|                                                                                                                                              | 13/300000 [00:16<97:19:23,  1.17s/it]  0%|                                                                                                                                              | 14/300000 [00:17<97:08:44,  1.17s/it]  0%|                                                                                                                                              | 15/300000 [00:18<97:11:55,  1.17s/it]  0%|                                                                                                                                             | 16/300000 [00:20<100:19:26,  1.20s/it]  0%|                                                                                                                                             | 17/300000 [00:21<100:32:11,  1.21s/it]  0%|                                                                                                                                              | 18/300000 [00:22<99:40:13,  1.20s/it]  0%|                                                                                                                                              | 19/300000 [00:23<98:40:00,  1.18s/it]  0%|                                                                                                                                              | 20/300000 [00:24<98:03:41,  1.18s/it]  0%|                                                                                                                                              | 21/300000 [00:25<97:40:37,  1.17s/it]  0%|                                                                                                                                              | 22/300000 [00:27<97:30:53,  1.17s/it]  0%|                                                                                                                                              | 23/300000 [00:28<98:28:59,  1.18s/it]  0%|                                                                                                                                              | 24/300000 [00:29<97:56:08,  1.18s/it]  0%|                                                                                                                                              | 25/300000 [00:30<97:33:39,  1.17s/it]  0%|                                                                                                                                              | 26/300000 [00:31<97:09:36,  1.17s/it]  0%|                                                                                                                                              | 27/300000 [00:32<96:43:25,  1.16s/it]  0%|                                                                                                                                              | 28/300000 [00:34<96:24:54,  1.16s/it]  0%|                                                                                                                                              | 29/300000 [00:35<96:41:17,  1.16s/it]  0%|                                                                                                                                              | 30/300000 [00:36<98:09:36,  1.18s/it]  0%|                                                                                                                                              | 31/300000 [00:37<98:32:34,  1.18s/it]  0%|                                                                                                                                              | 32/300000 [00:38<97:42:12,  1.17s/it]  0%|                                                                                                                                              | 33/300000 [00:39<97:09:30,  1.17s/it]  0%|                                                                                                                                              | 34/300000 [00:41<96:54:48,  1.16s/it]  0%|                                                                                                                                             | 35/300000 [00:43<117:28:11,  1.41s/it]  0%|                                                                                                                                             | 36/300000 [00:44<111:40:43,  1.34s/it]  0%|                                                                                                                                             | 37/300000 [00:45<107:28:26,  1.29s/it]  0%|                                                                                                                                             | 38/300000 [00:46<103:57:21,  1.25s/it]  0%|                                                                                                                                             | 39/300000 [00:47<101:26:00,  1.22s/it]  0%|                                                                                                                                              | 40/300000 [00:48<99:44:34,  1.20s/it]  0%|                                                                                                                                              | 41/300000 [00:49<98:46:23,  1.19s/it]  0%|                                                                                                                                              | 42/300000 [00:51<98:01:54,  1.18s/it]  0%|                                                                                                                                              | 43/300000 [00:52<99:24:10,  1.19s/it]  0%|                                                                                                                                              | 44/300000 [00:53<98:28:28,  1.18s/it]  0%|                                                                                                                                              | 45/300000 [00:54<97:43:15,  1.17s/it]  0%|                                                                                                                                              | 46/300000 [00:55<97:11:50,  1.17s/it]  0%|                                                                                                                                              | 47/300000 [00:56<96:57:08,  1.16s/it]  0%|                                                                                                                                              | 48/300000 [00:58<96:38:55,  1.16s/it]  0%|                                                                                                                                              | 49/300000 [00:59<96:19:11,  1.16s/it]  0%|                                                                                                                                              | 50/300000 [01:00<96:44:13,  1.16s/it]  0%|                                                                                                                                              | 51/300000 [01:01<97:56:20,  1.18s/it]  0%|                                                                                                                                              | 52/300000 [01:02<98:57:27,  1.19s/it]  0%|                                                                                                                                             | 53/300000 [01:04<100:21:26,  1.20s/it]  0%|                                                                                                                                              | 54/300000 [01:05<99:15:54,  1.19s/it]  0%|                                                                                                                                              | 55/300000 [01:06<98:16:03,  1.18s/it]  0%|                                                                                                                                              | 56/300000 [01:07<97:51:53,  1.17s/it]  0%|                                                                                                                                              | 57/300000 [01:08<97:40:50,  1.17s/it]  0%|                                                                                                                                              | 58/300000 [01:09<97:54:33,  1.18s/it]  0%|                                                                                                                                              | 59/300000 [01:11<97:25:53,  1.17s/it]  0%|                                                                                                                                              | 60/300000 [01:12<96:52:30,  1.16s/it]  0%|                                                                                                                                              | 61/300000 [01:13<96:47:59,  1.16s/it]  0%|                                                                                                                                              | 62/300000 [01:14<96:34:02,  1.16s/it]  0%|                                                                                                                                              | 63/300000 [01:15<96:25:59,  1.16s/it]  0%|                                                                                                                                              | 64/300000 [01:16<97:46:35,  1.17s/it]  0%|                                                                                                                                              | 65/300000 [01:18<97:28:06,  1.17s/it]  0%|                                                                                                                                              | 66/300000 [01:19<97:03:17,  1.16s/it]  0%|                                                                                                                                              | 67/300000 [01:20<96:41:52,  1.16s/it]  0%|                                                                                                                                              | 68/300000 [01:21<96:37:35,  1.16s/it]  0%|                                                                                                                                             | 69/300000 [01:23<118:56:54,  1.43s/it]  0%|                                                                                                                                             | 70/300000 [01:24<112:29:35,  1.35s/it]  0%|                                                                                                                                             | 71/300000 [01:25<108:35:16,  1.30s/it]  0%|                                                                                                                                             | 72/300000 [01:27<104:42:02,  1.26s/it]  0%|                                                                                                                                             | 73/300000 [01:28<102:11:09,  1.23s/it]  0%|                                                                                                                                             | 74/300000 [01:29<100:42:44,  1.21s/it]  0%|                                                                                                                                              | 75/300000 [01:30<99:42:34,  1.20s/it]  0%|                                                                                                                                              | 76/300000 [01:31<98:33:38,  1.18s/it]  0%|                                                                                                                                              | 77/300000 [01:32<98:10:21,  1.18s/it]  0%|                                                                                                                                             | 78/300000 [01:34<101:03:35,  1.21s/it]  0%|                                                                                                                                              | 79/300000 [01:35<99:31:54,  1.19s/it]  0%|                                                                                                                                              | 80/300000 [01:36<98:28:16,  1.18s/it]  0%|                                                                                                                                              | 81/300000 [01:37<97:48:00,  1.17s/it]  0%|                                                                                                                                              | 82/300000 [01:38<97:08:02,  1.17s/it]  0%|                                                                                                                                              | 83/300000 [01:39<96:47:30,  1.16s/it]  0%|                                                                                                                                              | 84/300000 [01:41<97:12:33,  1.17s/it]  0%|                                                                                                                                              | 85/300000 [01:42<98:15:30,  1.18s/it]  0%|                                                                                                                                              | 86/300000 [01:43<98:18:33,  1.18s/it]  0%|                                                                                                                                              | 87/300000 [01:44<97:42:01,  1.17s/it]  0%|                                                                                                                                              | 88/300000 [01:45<97:22:46,  1.17s/it]  0%|                                                                                                                                              | 89/300000 [01:47<96:52:06,  1.16s/it]  0%|                                                                                                                                              | 90/300000 [01:48<96:33:30,  1.16s/it]  0%|                                                                                                                                              | 91/300000 [01:49<96:59:21,  1.16s/it]  0%|                                                                                                                                              | 92/300000 [01:50<98:11:03,  1.18s/it]  0%|                                                                                                                                              | 93/300000 [01:51<97:48:59,  1.17s/it]  0%|                                                                                                                                              | 94/300000 [01:52<97:11:14,  1.17s/it]  0%|                                                                                                                                              | 95/300000 [01:54<96:55:30,  1.16s/it]  0%|                                                                                                                                              | 96/300000 [01:55<96:38:44,  1.16s/it]  0%|                                                                                                                                              | 97/300000 [01:56<96:33:55,  1.16s/it]  0%|                                                                                                                                              | 98/300000 [01:57<96:35:00,  1.16s/it]  0%|                                                                                                                                              | 99/300000 [01:58<98:09:13,  1.18s/it]  0%|                                                                                                                                             | 100/300000 [01:59<97:47:43,  1.17s/it]  0%|                                                                                                                                             | 101/300000 [02:01<97:34:02,  1.17s/it]  0%|                                                                                                                                             | 102/300000 [02:02<97:03:31,  1.17s/it]  0%|                                                                                                                                            | 103/300000 [02:04<118:19:48,  1.42s/it]  0%|                                                                                                                                            | 104/300000 [02:05<115:08:10,  1.38s/it]  0%|                                                                                                                                            | 105/300000 [02:06<109:41:45,  1.32s/it]  0%|                                                                                                                                            | 106/300000 [02:07<105:45:30,  1.27s/it]  0%|                                                                                                                                            | 107/300000 [02:08<103:01:40,  1.24s/it]  0%|                                                                                                                                            | 108/300000 [02:10<101:29:48,  1.22s/it]  0%|                                                                                                                                            | 109/300000 [02:11<100:03:40,  1.20s/it]  0%|                                                                                                                                             | 110/300000 [02:12<98:46:09,  1.19s/it]  0%|                                                                                                                                             | 111/300000 [02:13<98:04:41,  1.18s/it]  0%|                                                                                                                                             | 112/300000 [02:14<98:02:34,  1.18s/it]  0%|                                                                                                                                             | 113/300000 [02:15<97:36:57,  1.17s/it]  0%|                                                                                                                                             | 114/300000 [02:17<97:19:36,  1.17s/it]  0%|                                                                                                                                             | 115/300000 [02:18<99:08:44,  1.19s/it]  0%|                                                                                                                                             | 116/300000 [02:19<98:26:22,  1.18s/it]  0%|                                                                                                                                             | 117/300000 [02:20<97:39:52,  1.17s/it]  0%|                                                                                                                                             | 118/300000 [02:21<97:02:40,  1.16s/it]  0%|                                                                                                                                             | 119/300000 [02:22<96:52:21,  1.16s/it]  0%|                                                                                                                                             | 120/300000 [02:24<96:31:08,  1.16s/it]  0%|                                                                                                                                             | 121/300000 [02:25<96:25:42,  1.16s/it]  0%|                                                                                                                                             | 122/300000 [02:26<96:11:58,  1.15s/it]  0%|                                                                                                                                             | 123/300000 [02:27<96:08:52,  1.15s/it]  0%|                                                                                                                                             | 124/300000 [02:28<96:04:34,  1.15s/it]  0%|                                                                                                                                             | 125/300000 [02:29<96:08:20,  1.15s/it]  0%|                                                                                                                                             | 126/300000 [02:31<97:31:52,  1.17s/it]  0%|                                                                                                                                             | 127/300000 [02:32<98:17:04,  1.18s/it]  0%|                                                                                                                                             | 128/300000 [02:33<97:48:40,  1.17s/it]  0%|                                                                                                                                             | 129/300000 [02:34<97:11:28,  1.17s/it]  0%|                                                                                                                                             | 130/300000 [02:35<96:45:50,  1.16s/it]  0%|                                                                                                                                             | 131/300000 [02:36<96:43:59,  1.16s/it]  0%|                                                                                                                                             | 132/300000 [02:38<96:28:06,  1.16s/it]  0%|                                                                                                                                             | 133/300000 [02:39<96:33:58,  1.16s/it]  0%|                                                                                                                                             | 134/300000 [02:40<97:19:44,  1.17s/it]  0%|                                                                                                                                             | 135/300000 [02:41<97:03:29,  1.17s/it]  0%|                                                                                                                                             | 136/300000 [02:42<96:39:27,  1.16s/it]  0%|                                                                                                                                            | 137/300000 [02:44<118:08:02,  1.42s/it]  0%|                                                                                                                                            | 138/300000 [02:45<111:50:49,  1.34s/it]  0%|                                                                                                                                            | 139/300000 [02:47<107:27:57,  1.29s/it]  0%|                                                                                                                                            | 140/300000 [02:48<105:35:16,  1.27s/it]  0%|                                                                                                                                            | 141/300000 [02:49<103:08:27,  1.24s/it]  0%|                                                                                                                                            | 142/300000 [02:50<101:16:43,  1.22s/it]  0%|                                                                                                                                             | 143/300000 [02:51<99:43:05,  1.20s/it]  0%|                                                                                                                                             | 144/300000 [02:52<98:51:52,  1.19s/it]  0%|                                                                                                                                             | 145/300000 [02:54<97:54:02,  1.18s/it]  0%|                                                                                                                                             | 146/300000 [02:55<97:38:58,  1.17s/it]  0%|                                                                                                                                             | 147/300000 [02:56<97:51:10,  1.17s/it]  0%|                                                                                                                                             | 148/300000 [02:57<97:19:31,  1.17s/it]  0%|                                                                                                                                             | 149/300000 [02:58<96:48:07,  1.16s/it]  0%|                                                                                                                                             | 150/300000 [02:59<96:30:04,  1.16s/it]  0%|                                                                                                                                             | 151/300000 [03:01<96:18:57,  1.16s/it]  0%|                                                                                                                                             | 152/300000 [03:02<96:20:11,  1.16s/it]  0%|                                                                                                                                             | 153/300000 [03:03<96:24:28,  1.16s/it]^C  0%|                                                                                                                                            | 153/300000 [03:04<100:28:31,  1.21s/it]
Traceback (most recent call last):
  File "train_t2m_trans.py", line 179, in <module>
    loss_cls.backward()
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/epinyoan/miniconda3/envs/T2M-GPT/lib/python3.8/site-packages/torch/autograd/__init__.py", line 145, in backward
    Variable._execution_engine.run_backward(
KeyboardInterrupt
